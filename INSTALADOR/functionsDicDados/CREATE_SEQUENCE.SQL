CREATE OR REPLACE FUNCTION comp.create_sequence(id_sequence numeric, id_application numeric, nm_schema character varying)
 RETURNS void
 LANGUAGE plpgsql
AS $function$

DECLARE
TEXT_W		VARCHAR(400);
SEQUENCE_NAME_W VARCHAR(50);
INITIAL_VALUE	NUMERIC(10,0);
INICIALIZED	BOOLEAN = FALSE;

BEGIN

SELECT 	A.NAME, COALESCE(A.VL_INICIALIZATION,0)
INTO 	SEQUENCE_NAME_W, INITIAL_VALUE
FROM 	COMP.SYSTEM_SEQUENCE A
WHERE 	A.ID = $1;

TEXT_W := 'CREATE SEQUENCE ' || $3 || '.' || SEQUENCE_NAME_W || ' INCREMENT 1 ';

IF (INITIAL_VALUE > 0) THEN
	TEXT_W := TEXT_W || ' START ' || INITIAL_VALUE || ';';
	INICIALIZED := TRUE;
ELSE
	TEXT_W := TEXT_W || ' START 1;';
END IF;

IF COMP.EXECUTE_STATEMENT(TEXT_W) THEN
	IF (INICIALIZED) THEN
		UPDATE COMP.SYSTEM_SEQUENCE SET VL_INICIALIZATION = NULL WHERE ID = $1;
	END IF;
END IF;

END;
$function$
