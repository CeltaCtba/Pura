CREATE OR REPLACE FUNCTION comp.create_object(id_object numeric, id_application numeric, nm_schema character varying)
  RETURNS void AS
$BODY$
DECLARE

TEXT_W	TEXT;
TYPE_W 	NUMERIC;

BEGIN

SELECT 	A.DS_OBJECT, A.ID_DOMAIN_VALUE_TYPE
INTO 	TEXT_W, TYPE_W
FROM 	COMP.SYSTEM_OBJECT A
WHERE 	A.ID = $1
AND	A.ID_DOMAIN_VALUE_TYPE <> 20; 

IF (((POSITION('EXECUTE_STATEMENT' IN UPPER(TEXT_W)) = 0) 
	AND (POSITION('CREATE_OBJECT' IN UPPER(TEXT_W)) = 0) 
	AND (POSITION('WRITE_SQL_LOG' IN UPPER(TEXT_W)) = 0) 
	AND (POSITION('DEFAULT' IN UPPER(TEXT_W)) = 0)) 
	AND (TYPE_W IN (13,32))) THEN
	--PERFORM COMP.EXECUTE_STATEMENT(REPLACE(UPPER('DROP ' || SUBSTRING(TEXT_W FROM (POSITION('REPLACE' IN UPPER(TEXT_W))+7) FOR (POSITION('RETURNS' IN UPPER(TEXT_W))-(POSITION('REPLACE' IN UPPER(TEXT_W))+7)))),'FUNCTION','FUNCTION IF EXISTS'));
END IF;
PERFORM COMP.EXECUTE_STATEMENT(TEXT_W);

END;
$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100;
