CREATE OR REPLACE FUNCTION comp.show_err()
 RETURNS text
 LANGUAGE plpgsql
AS $function$
DECLARE
VRESULT TEXT := '';
ERR_COUNT INTEGER := 0;
VDUR INTERVAL;
REC RECORD;
BEGIN
	EXECUTE 'SELECT COALESCE(COUNT(1),0) FROM COMP.LOG_SYNCHRONIZER WHERE LEVEL = 0' INTO ERR_COUNT;
	
	IF (ERR_COUNT = 0) THEN
		VRESULT := COMP.GET_EXPRESSION_TEXT(72);
	ELSE		
		FOR REC IN
			SELECT 	INITCAP(SC.NAME) SCHEMA_NAME,
				COALESCE(COMP.GET_EXPRESSION_TEXT(LS.ID_EXPRESSION_MESSAGE),'') TXT,
				COALESCE(LS.ADITIONAL_TEXT,'') ADITIONAL_TEXT
			FROM	COMP.DATABASE_SCHEMA SC,
				COMP.LOG_SYNCHRONIZER LS
			WHERE	LS.ID_DATABASE_SCHEMA = SC.ID
			AND	LS.LEVEL = 0
			GROUP BY 1,2,3
			ORDER BY 1,2,3
		LOOP
			VRESULT := VRESULT || COMP.GET_EXPRESSION_TEXT(66) || ' ' || REC.SCHEMA_NAME || chr(13) || chr(10);
			VRESULT := VRESULT || REC.TXT || chr(13) || chr(10);
			VRESULT := VRESULT || REC.ADITIONAL_TEXT || chr(13) || chr(10) || chr(13) || chr(10);
		END LOOP;
	END IF;

	RETURN VRESULT;
END;
$function$
