CREATE OR REPLACE FUNCTION comp.write_structure_error_log(id_expression numeric, vtext_1 character varying, vtext_2 character varying, vtext_3 character varying)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
DECLARE
MASTER_LOG_ID		NUMERIC;
MASTER_LOG_SCHEMA 	NUMERIC;
VLOG_TEXT 			TEXT;
BEGIN
	SELECT ID, ID_DATABASE_SCHEMA INTO MASTER_LOG_ID, MASTER_LOG_SCHEMA FROM TB_LOG ORDER BY ID DESC LIMIT 1;
	
	
	IF ($1 = 68) THEN
		VLOG_TEXT := COMP.GET_EXPRESSION_TEXT(69) || $2 || '   ' || COMP.GET_EXPRESSION_TEXT(70) || $3; 
	ELSIF ($1 = 138) THEN
		VLOG_TEXT := $2; 
	ELSE
		VLOG_TEXT := $2;
	END IF;
		
	BEGIN
	INSERT INTO COMP.LOG_SYNCHRONIZER(LEVEL,INITIAL_TIME,ID_EXPRESSION_MESSAGE,ADITIONAL_TEXT,ID_DATABASE_SCHEMA,ID_SUP)
		VALUES
		(0,CURRENT_TIMESTAMP,$1,VLOG_TEXT,MASTER_LOG_SCHEMA,MASTER_LOG_ID);
	EXCEPTION WHEN unique_violation THEN
	END;			
END;
$function$
