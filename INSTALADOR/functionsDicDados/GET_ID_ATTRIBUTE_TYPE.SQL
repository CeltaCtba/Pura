CREATE OR REPLACE FUNCTION comp.get_id_attribute_type(type_p character varying)
 RETURNS integer
 LANGUAGE plpgsql
AS $function$
DECLARE
VRESULT INTEGER := 99;
BEGIN
	IF ((UPPER($1) = 'CHARACTER VARYING') OR (UPPER($1) = 'CHARACTER')) THEN
		$1 := 'VARCHAR';
	END IF;

	IF ((UPPER($1) = 'TIMESTAMP WITH TIME ZONE') OR (UPPER($1) = 'TIMESTAMP WITHOUT TIME ZONE')) THEN
		$1 := 'TIMESTAMP';
	END IF;
	

	SELECT 	DV.ID
	INTO 	VRESULT
	FROM 	COMP.DOMAIN_VALUE DV,
		COMP.EXPRESSION E
	WHERE	DV.ID_EXPRESSION = E.ID
	AND	UPPER(E.DS_POR) = UPPER($1);

	RETURN VRESULT;
END;
$function$
